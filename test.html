<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>title</title>
    
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.12.0/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.12.0/firebase-analytics.js"></script>
    <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "AIzaSyAFgrfKyJNyFs87r5mE5dPX_u22eJcbD1k",
      authDomain: "interpretermatch.firebaseapp.com",
      databaseURL: "https://interpretermatch.firebaseio.com",
      projectId: "interpretermatch",
      storageBucket: "interpretermatch.appspot.com",
      messagingSenderId: "326479919629",
      appId: "1:326479919629:web:d73cf91f0017bb701bf344",
      measurementId: "G-EQCEE8DV2B"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    
    // Get a reference to the database service
    var database = firebase.database();

  </script>
  </head>
  <body>
    <img id="gravatar" />
    <h2>Firebase Example</h2>
    <input type='text' id='messageInput'  placeholder='Enter your data here...'>
    <button type="button" onclick="savedata()">Save Data</button>
    <br><br><br>
    <hr>
    <h2>Results</h2>
    <textarea rows="10" cols="50" id="results"></textarea>
    <script>
    var messagesRef = new Firebase('https://interpretermatch.firebaseio.com');
    var userId = 0;

    // For user authentication
    function authHandler(error, authData) {
      if (error) {
        console.log('Login Failed!', error);
      } else {
        // Set the gravatar
        document.getElementById('gravatar').src = authData.password.profileImageURL;
      }
    }

    // Log the user in with an email combination
    messagesRef.authWithPassword({
      email    : 'hello@deanhume.com',
      password : 'dean123'
    }, authHandler);

    messagesRef.onAuth(function(authData) {
       userId = authData.uid;
    });

    var messageField = document.getElementById('messageInput');
    var messageResults = document.getElementById('results');

    // Save data to firebase
    function savedata(){
      var message = messageField.value;

      messagesRef.child('users').child(userId).push({fieldName:'messageField', text:message});
      messageField.value = '';
    }

    // Update results when data is added
    messagesRef.child('users').child(userId).limitToLast(10).on('child_added', function (snapshot) {
        var data = snapshot.val();
        console.log(snapshot.val());
        var message = data.text;

        if (message != undefined)
        {
          messageResults.value += '\n' + message;
        }
    });
    </script>
  </body>
</html>